<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>后台管理系统</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- bootstrap -->
    <link rel="stylesheet" href="../../src/libs/bootstrap-3.3.6/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="../../src/libs/font-awesome-4.5.0/css/font-awesome.min.css">
    <!-- 主题 -->
    <link rel="stylesheet" href="../../src/css/app.css">

    <!-- HTML5 Shim and Respond.js IE8 支持HTML5元素和媒体查询 -->
    <!-- 警告: Respond.js使用file://无法正常工作 -->
    <!--[if lt IE 9]>
        <script src="../../src/js/html5shiv.min.js"></script>
        <script src="../../src/js/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <!-- 页面容器 -->
    <div class="wrapper">
      <!-- Main content -->
      <section class="content">
        <div class="page">
          <div class="page-header">
            
            <ol class="breadcrumb">
              <li><a href="#">系统管理</a></li>
              <li class="active">角色管理</li>
            </ol>
          </div><!-- /.page-header -->
          <div class="page-body">
            <div class="" id="toolbar">
              <button class="btn btn-primary" data-toggle="modal" data-target="#addModal"><i class="fa fa-plus"></i>新增角色</button>
            </div>
            <table id="table"></table>
          </div><!-- /.page-body -->
        </div><!-- /.page -->
      </section><!-- /.content -->
    </div><!-- 页面容器 -->
    <!-- 添加Modal -->
    <div class="modal" id="addModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span></button>
            <h4 class="modal-title">新增角色</h4>
          </div>
          <div class="modal-body clearfix">
            <form class="form-horizontal" id="form-add">
              <div class="form-group">
                <label class="col-sm-2 control-label"><span class="text-red">*</span>角色名称</label>
                <div class="col-sm-8 col-md-6 ">
                  <input type="text" class="form-control" name="role"  placeholder="请输入角色名称" validate="{required:true}">
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">角色类型</label>
                <div class="col-sm-8 col-md-6 ">
                  <select class="form-control" name="roleType" disabled>
                    <option value="0">系统</option>
                    <option value="1" selected>自定义</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">角色描述</label>
                <div class="col-sm-8 col-md-6 ">
                  <textarea class="form-control" name="roleDesc" placeholder="角色描述..."></textarea>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-reply"></i>取消</button>
            <button type="button" class="btn btn-primary" id="modal-add-save"><i class="fa fa-save"></i>保存</button>
          </div>
        </div>
      </div>
    </div>
    <!-- 编辑Modal -->
    <div class="modal" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span></button>
            <h4 class="modal-title">新增角色</h4>
          </div>
          <div class="modal-body clearfix">
            <form class="form-horizontal" id="form-edit">
              <div class="form-group">
                <label class="col-sm-2 control-label"><span class="text-red">*</span>角色名称</label>
                <div class="col-sm-8 col-md-6 ">
                  <input type="text" class="form-control" name="role"  placeholder="请输入角色名称" validate="{required:true}">
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">角色类型</label>
                <div class="col-sm-8 col-md-6 ">
                  <select class="form-control" name="roleType" disabled>
                    <option value="0">系统</option>
                    <option value="1">自定义</option>
                  </select>
                </div>
              </div>
              <div class="form-group">
                <label class="col-sm-2 control-label">角色描述</label>
                <div class="col-sm-8 col-md-6 ">
                  <textarea class="form-control" name="roleDesc" placeholder="角色描述..."></textarea>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-reply"></i>取消</button>
            <button type="button" class="btn btn-primary" id="modal-edit-save"><i class="fa fa-save"></i>保存</button>
          </div>
        </div>
      </div>
    </div>
    <!-- jQuery 2.1.4 -->
    <script src="../../src/libs/jQuery/jquery-2.2.3.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="../../src/libs/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <!-- jquery.validate -->
    <script src="../../src/libs/jquery.validate/jquery.validate.js"></script>
    <script src="../../src/libs/jquery.validate/validate.extend.js"></script>
    <!-- bootstrap-table -->
    <link rel="stylesheet" href="../../src/libs/bootstrap-table/bootstrap-table.css">
    <script src="../../src/libs/bootstrap-table/bootstrap-table.min.js"></script>
    <!--公用common.js-->
    <link rel="stylesheet" href="../../src/libs/layer/skin/default/layer.css">
    <script src="../../src/libs/layer/layer.js"></script>
    <script src="../../src/js/common.js"></script>
    <!-- 业务逻辑js -->
    <script >
      $(function(){
        page.init();
      });
      var page=(function(){
        var tableInit=function(){
          var dataList=[
            {
              id:'1',
              role:'系统管理员',
              roleType:'0',
              roleDesc:'系统管理员拥有最高级权限',
              creatPerson:'admin',
              creatTime:'2017-04-01 00:00:00',
              updatePerson:'admin',
              updateTime:'2017-04-01 00:00:00'
            },
            {
              id:'2',
              role:'管理员',
              roleType:'0',
              roleDesc:'拥有管理用户的部分权限',
              creatPerson:'admin',
              creatTime:'2017-04-01 00:00:00',
              updatePerson:'admin',
              updateTime:'2017-04-01 00:00:00'
            },
            {
              id:'3',
              role:'普通用户',
              roleType:'1',
              roleDesc:'普通用户功能',
              creatPerson:'admin',
              creatTime:'2017-04-01 10:11:12',
              updatePerson:'admin',
              updateTime:'2017-05-01 12:13:14'
            }

          ];
          var columns=[
            {
              field:"role",title:"角色名称"
            },
            {
              field:"roleType",title:"角色类型",
              formatter:function(value,row,index){
                return value=="0"?"系统":"自定义"
              }
            },
            {
              field:"roleDesc",title:"角色描述"
            },
            {
              field:"creatPerson",title:"创建人"
            },
            {
              field:"creatTime",title:"创建时间"
            },
            {
              field:"updatePerson",title:"修改人"
            },
            {
              field:"updateTime",title:"修改时间"
            },
            {
              field:"",title:"操作",
              formatter:function(value,row,index){
                return '<div class="btn-group">' +
                    '<button type="button" class="btn btn-xs btn-primary" onclick="page.edit('+row.id+')">修改角色</button>' +
                    '<button type="button" class="btn btn-xs btn-primary" onclick="page.freezeRole('+row.id+')">冻结角色</button>' +
                    '<button type="button" class="btn btn-xs btn-primary" onclick="page.assignUser('+row.id+')">分配用户</button>' +
                    '</div>'
              }
            }
          ];
          var option={
            data:dataList,  //需切换common => sidePagination
            url:'/api/v1/role',
            columns: columns, //列
            idField: "id",  //标识哪个字段为id主键
            uniqueId:"id"//给每行一个唯一标识
          };
          option=common.extend(common.getBootstrapTableOption(),option);
          $("#table").bootstrapTable(option);
        };
        //组件初始化；
        var componentInit=function(){
          formValidateInit("#form-add");
          formValidateInit("#form-edit");
        };
        var btnActionInit=function(){
          $("#modal-add-save").on("click",function(){
            var valid=$("#form-add").valid();
            if(!valid)return;
          });
          $("#modal-edit-save").on("click",function(){
            var valid=$("#form-edit").valid();
            if(!valid)return;
          });
        };
        return {
          init:function(){
            tableInit();
            componentInit();
            btnActionInit();
          },
          edit:function(id){
            var row=$("#table").bootstrapTable('getRowByUniqueId',id);
            //row插入表单
            $("#form-edit [name='role']").val(row.role);
            $("#form-edit [name='roleType']").val(row.roleType);
            $("#form-edit [name='roleDesc']").val(row.roleDesc);
            $("#editModal").modal("show");
          },
          freezeRole:function(id){
            $.msg("冻结角色");
          },
          assignUser:function(id){
            $.msg("分配用户");
          }
        }
      })();
    </script>
  </body>
</html>
